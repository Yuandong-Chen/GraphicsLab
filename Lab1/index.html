<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title></title>
    <script type="text/javascript" src="http://d3js.org/d3.v3.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script type="text/javascript" src="./ViewModel/device.js"></script>
    <script type="text/javascript" src="./ViewModel/normalizeToDevice.js"></script>
    <script type="text/javascript" src="./ViewModel/viewModel.js"></script>
    <script type="text/javascript" src="./Model/model.js"></script>
    <style type="text/css">
      canvas {
        float: left;
      }
      .control_panel {
        float: right;
      }

      .clearfix {
        display: inline-block;
        margin-left: 40px;
        overflow: auto;
      }
    </style>
</head>
<body>
<canvas id="canvas" width="800" height="600"></canvas>
<div class="clearfix">
<div id="control_panel">
Camera parameter:
<div class="slidecontainer">
  <input type="range" min="1" max="100" value="50" class="slider" id="C_h">
  <p>h: <span id="V_C_h"></span></p>
</div>
<div class="slidecontainer">
  <input type="range" min="1" max="100" value="25" class="slider" id="C_d">
  <p>d: <span id="V_C_d"></span></p>
</div>
<div class="slidecontainer">
  <input type="range" min="1" max="100" value="50" class="slider" id="C_f">
  <p>f: <span id="V_C_f"></span></p>
</div>
</div>
<script type="text/javascript">

var slider = document.getElementById("C_d");
var output = document.getElementById("V_C_d");
output.innerHTML = slider.value;
slider.oninput = function() {
  output.innerHTML = this.value;
}
var slider2 = document.getElementById("C_h");
var output2 = document.getElementById("V_C_h");
output2.innerHTML = slider2.value;
slider2.oninput = function() {
  output2.innerHTML = this.value;
}
var slider3 = document.getElementById("C_f");
var output3 = document.getElementById("V_C_f");
output3.innerHTML = slider3.value;
slider3.oninput = function() {
  output3.innerHTML = this.value;
}

let node = document.getElementById('canvas');
node.requestPointerLock = node.requestPointerLock || node.mozRequestPointerLock || node.webkitRequestPointerLock;
node.requestPointerLock();
let ctx = node.getContext('2d');
let height = node.height;
let width = node.width;
let ticks = 64;
$(document).on("keypress", function (e) {
    console.log(e.which);
    window.model = d3.range(height).map(function(d, i){return d3.range(width).map(function(d, i){return ~~(Math.random()*255);});});
});

window.model = d3.range(height).map(function(d, i){return d3.range(width).map(function(d, i){return ~~(Math.random()*255);});});
var draw = () => {
  viewModel(height, width, ticks, ctx, pureModel(window.model));
  window.requestAnimationFrame(draw);
}
draw();
</script>
</body>
</html>
